============================= test session starts =============================
platform win32 -- Python 3.14.2, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Rodrigo\AppData\Local\Programs\Python\Python314\python.exe
cachedir: .pytest_cache
django: version: 6.0.1, settings: caixa_nfse.settings.test (from ini)
rootdir: C:\Users\Rodrigo\Projetos\wCaixaDigital
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.1, Faker-40.1.2, django-4.11.1
collecting ... collected 186 items

caixa_nfse/api/tests/test_serializers.py::TestCaixaSerializer::test_valid_data PASSED [  0%]
caixa_nfse/api/tests/test_serializers.py::TestCaixaSerializer::test_read_only_fields PASSED [  1%]
caixa_nfse/api/tests/test_serializers.py::TestClienteSerializer::test_valid_data PASSED [  1%]
caixa_nfse/api/tests/test_serializers.py::TestNotaFiscalSerializer::test_serialize_data PASSED [  2%]
caixa_nfse/api/tests/test_views.py::TestCaixaViewSet::test_list_caixas_tenant_isolation FAILED [  2%]
caixa_nfse/api/tests/test_views.py::TestCaixaViewSet::test_list_no_tenant_user FAILED [  3%]
caixa_nfse/api/tests/test_views.py::TestCaixaViewSet::test_create_caixa PASSED [  3%]
caixa_nfse/api/tests/test_views.py::TestClienteViewSet::test_list_clientes FAILED [  4%]
caixa_nfse/api/tests/test_views.py::TestClienteViewSet::test_create_cliente PASSED [  4%]
caixa_nfse/api/tests/test_views.py::TestNotaFiscalViewSet::test_list_notas FAILED [  5%]
caixa_nfse/api/tests/test_views.py::TestNotaFiscalViewSet::test_create_nota_simple FAILED [  5%]
caixa_nfse/api/tests/test_views.py::TestAuth::test_unauthenticated PASSED [  6%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_create_generates_hash PASSED [  6%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_chaining FAILED [  7%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_immutability_update PASSED [  8%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_immutability_delete PASSED [  8%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_registrar_helper PASSED [  9%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_registrar_with_request FAILED [  9%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_integridade_tenant_filter FAILED [ 10%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_integridade_ok PASSED [ 10%]
caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_integridade_broken FAILED [ 11%]
caixa_nfse/backoffice/tests/test_forms.py::TestTenantOnboardingForm::test_create_tenant_and_admin PASSED [ 11%]
caixa_nfse/backoffice/tests/test_forms.py::TestTenantUserForm::test_create_user_requires_password PASSED [ 12%]
caixa_nfse/backoffice/tests/test_forms.py::TestTenantUserForm::test_update_user_password_optional PASSED [ 12%]
caixa_nfse/backoffice/tests/test_views.py::TestPlatformDashboardView::test_access_denied_for_non_superuser PASSED [ 13%]
caixa_nfse/backoffice/tests/test_views.py::TestPlatformDashboardView::test_access_allowed_superuser PASSED [ 13%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantCRUD::test_update_tenant PASSED [ 14%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantCRUD::test_create_tenant_flow FAILED [ 15%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantCRUD::test_delete_tenant FAILED [ 15%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantUserManagement::test_add_user_form_view PASSED [ 16%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantUserManagement::test_add_user_htmx PASSED [ 16%]
caixa_nfse/backoffice/tests/test_views.py::TestTenantUserManagement::test_update_user_htmx PASSED [ 17%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_clean_valor_formato_brasileiro PASSED [ 17%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_clean_valor_simples PASSED [ 18%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_clean_valor_com_rs PASSED [ 18%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_clean_valor_vazio_retorna_zero PASSED [ 19%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_clean_valor_invalido PASSED [ 19%]
caixa_nfse/caixa/tests/test_forms.py::TestMovimentoCaixaForm::test_tipo_inicial_entrada PASSED [ 20%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_clean_saldo_informado_formato_brasileiro PASSED [ 20%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_clean_saldo_informado_simples PASSED [ 21%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_clean_saldo_vazio_erro PASSED [ 22%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_justificativa_obrigatoria_com_diferenca PASSED [ 22%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_justificativa_nao_obrigatoria_sem_diferenca PASSED [ 23%]
caixa_nfse/caixa/tests/test_forms.py::TestFechamentoCaixaForm::test_diferenca_pequena_tolerada PASSED [ 23%]
caixa_nfse/caixa/tests/test_forms.py::TestAbrirCaixaForm::test_form_fields PASSED [ 24%]
caixa_nfse/caixa/tests/test_forms.py::TestAbrirCaixaForm::test_valid_form PASSED [ 24%]
caixa_nfse/caixa/tests/test_models.py::TestCaixaModel::test_create_caixa PASSED [ 25%]
caixa_nfse/caixa/tests/test_models.py::TestCaixaModel::test_caixa_str PASSED [ 25%]
caixa_nfse/caixa/tests/test_models.py::TestCaixaModel::test_caixa_status_inicial PASSED [ 26%]
caixa_nfse/caixa/tests/test_models.py::TestCaixaModel::test_caixa_esta_aberto_false PASSED [ 26%]
caixa_nfse/caixa/tests/test_models.py::TestCaixaModel::test_caixa_unique_identificador_per_tenant PASSED [ 27%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_create_abertura PASSED [ 27%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_saldo_movimentos_sem_movimentos PASSED [ 28%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_saldo_movimentos_com_entrada PASSED [ 29%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_saldo_movimentos_com_saida PASSED [ 29%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_total_entradas PASSED [ 30%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_total_saidas PASSED [ 30%]
caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_is_operacional_hoje FAILED [ 31%]
caixa_nfse/caixa/tests/test_models.py::TestMovimentoCaixaModel::test_create_movimento PASSED [ 31%]
caixa_nfse/caixa/tests/test_models.py::TestMovimentoCaixaModel::test_movimento_is_entrada PASSED [ 32%]
caixa_nfse/caixa/tests/test_models.py::TestMovimentoCaixaModel::test_movimento_is_saida PASSED [ 32%]
caixa_nfse/caixa/tests/test_models.py::TestMovimentoCaixaModel::test_movimento_sangria_is_saida PASSED [ 33%]
caixa_nfse/caixa/tests/test_models.py::TestMovimentoCaixaModel::test_movimento_suprimento_is_entrada PASSED [ 33%]
caixa_nfse/caixa/tests/test_models.py::TestFechamentoCaixaModel::test_create_fechamento PASSED [ 34%]
caixa_nfse/caixa/tests/test_models.py::TestFechamentoCaixaModel::test_fechamento_diferenca_zero PASSED [ 34%]
caixa_nfse/caixa/tests/test_models.py::TestFechamentoCaixaModel::test_fechamento_diferenca_positiva PASSED [ 35%]
caixa_nfse/caixa/tests/test_models.py::TestFechamentoCaixaModel::test_fechamento_diferenca_negativa PASSED [ 36%]
caixa_nfse/caixa/tests/test_models.py::TestFechamentoCaixaModel::test_fechamento_status_inicial PASSED [ 36%]
caixa_nfse/caixa/tests/test_views.py::TestCaixaListView::test_list_caixas_authenticated PASSED [ 37%]
caixa_nfse/caixa/tests/test_views.py::TestCaixaListView::test_list_caixas_unauthenticated PASSED [ 37%]
caixa_nfse/caixa/tests/test_views.py::TestCaixaCreateView::test_create_caixa_success PASSED [ 38%]
caixa_nfse/caixa/tests/test_views.py::TestCaixaCreateView::test_create_caixa_duplicate_error PASSED [ 38%]
caixa_nfse/caixa/tests/test_views.py::TestAbrirCaixaView::test_get_abrir_caixa_page PASSED [ 39%]
caixa_nfse/caixa/tests/test_views.py::TestAbrirCaixaView::test_abrir_caixa_success PASSED [ 39%]
caixa_nfse/caixa/tests/test_views.py::TestAbrirCaixaView::test_abrir_caixa_already_open_redirect PASSED [ 40%]
caixa_nfse/caixa/tests/test_views.py::TestNovoMovimentoView::test_movimento_success FAILED [ 40%]
caixa_nfse/caixa/tests/test_views.py::TestNovoMovimentoView::test_movimento_invalid_form FAILED [ 41%]
caixa_nfse/caixa/tests/test_views.py::TestFecharCaixaView::test_get_fechar_caixa_page PASSED [ 41%]
caixa_nfse/caixa/tests/test_views.py::TestFecharCaixaView::test_fechar_caixa_success PASSED [ 42%]
caixa_nfse/caixa/tests/test_views.py::TestFecharCaixaView::test_fechar_caixa_error_closed PASSED [ 43%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCaixaUpdateView::test_update_caixa_success PASSED [ 43%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCaixaUpdateView::test_update_caixa_context PASSED [ 44%]
caixa_nfse/caixa/tests/test_views_extra.py::TestListaMovimentosView::test_list_movimentos PASSED [ 44%]
caixa_nfse/caixa/tests/test_views_extra.py::TestFechamentosPendentesView::test_list_pendentes_manager PASSED [ 45%]
caixa_nfse/caixa/tests/test_views_extra.py::TestFechamentosPendentesView::test_list_pendentes_forbidden PASSED [ 45%]
caixa_nfse/caixa/tests/test_views_extra.py::TestAprovarFechamentoView::test_aprovar_fechamento_success PASSED [ 46%]
caixa_nfse/caixa/tests/test_views_extra.py::TestAprovarFechamentoView::test_rejeitar_fechamento_success PASSED [ 46%]
caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_movimento_saida_decreases_balance FAILED [ 47%]
caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_block_retroactive_movement FAILED [ 47%]
caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_htmx_request_returns_partial FAILED [ 48%]
caixa_nfse/caixa/tests/test_views_extra.py::TestFecharCaixaExtra::test_fechar_htmx_response PASSED [ 48%]
caixa_nfse/caixa/tests/test_views_extra.py::TestFecharCaixaExtra::test_fechar_com_diferenca PASSED [ 49%]
caixa_nfse/caixa/tests/test_views_extra.py::TestFecharCaixaExtra::test_fechar_htmx_post_success PASSED [ 50%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCaixaDetailView::test_detail_view PASSED [ 50%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCaixaCreateViewExtra::test_create_caixa_context PASSED [ 51%]
caixa_nfse/caixa/tests/test_views_extra.py::TestAbrirCaixaExtra::test_abrir_htmx_post_success PASSED [ 51%]
caixa_nfse/caixa/tests/test_views_extra.py::TestAbrirCaixaExtra::test_abrir_htmx_get_partial PASSED [ 52%]
caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoHTMX::test_movimento_htmx_post_success FAILED [ 52%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_tenant_mixin_no_tenant PASSED [ 53%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_fechar_caixa_permission_denied PASSED [ 53%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_fechar_caixa_manager_other_operator PASSED [ 54%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_fechar_caixa_post_no_abertura FAILED [ 54%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_rejeitar_fechamento_sem_justificativa ERROR [ 55%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_novo_movimento_retroactive_htmx FAILED [ 55%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageFinal::test_fechar_caixa_access_denied_for_non_opener_non_manager PASSED [ 56%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageFinal::test_calcular_detalhamento_loop PASSED [ 56%]
caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageFinal::test_fechar_caixa_post_race_condition FAILED [ 57%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_create_cliente_pf PASSED [ 58%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_valid_documents FAILED [ 58%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_create_cliente_pj PASSED [ 59%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_invalid_cpf PASSED [ 59%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_invalid_cnpj PASSED [ 60%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_invalid_cpf_checksum PASSED [ 60%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_invalid_cnpj_checksum PASSED [ 61%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_get_absolute_url PASSED [ 61%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_documento_formatado_fallback PASSED [ 62%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_unique_document_per_tenant PASSED [ 62%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_allows_duplicate_document_different_tenants PASSED [ 63%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_endereco_completo PASSED [ 63%]
caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_documento_formatado PASSED [ 64%]
caixa_nfse/contabil/tests/test_models.py::TestPlanoContas::test_create_plano_contas PASSED [ 65%]
caixa_nfse/contabil/tests/test_models.py::TestPlanoContas::test_unique_codigo_per_tenant PASSED [ 65%]
caixa_nfse/contabil/tests/test_models.py::TestPlanoContas::test_allows_duplicate_codigo_different_tenants PASSED [ 66%]
caixa_nfse/contabil/tests/test_models.py::TestPlanoContas::test_hierarquia_contas PASSED [ 66%]
caixa_nfse/contabil/tests/test_models.py::TestCentroCusto::test_create_centro_custo PASSED [ 67%]
caixa_nfse/contabil/tests/test_models.py::TestCentroCusto::test_unique_codigo_per_tenant PASSED [ 67%]
caixa_nfse/contabil/tests/test_models.py::TestLancamentoContabil::test_create_lancamento PASSED [ 68%]
caixa_nfse/contabil/tests/test_models.py::TestLancamentoContabil::test_create_with_partidas PASSED [ 68%]
caixa_nfse/contabil/tests/test_models.py::TestLancamentoContabil::test_estorno_relationship PASSED [ 69%]
caixa_nfse/contabil/tests/test_models.py::TestPartidaLancamento::test_create_partida PASSED [ 69%]
caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_list_plano_contas FAILED [ 70%]
caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_filter_tenant FAILED [ 70%]
caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_access_without_tenant FAILED [ 71%]
caixa_nfse/contabil/tests/test_views.py::TestLancamentoListView::test_list_lancamentos FAILED [ 72%]
caixa_nfse/contabil/tests/test_views.py::TestLancamentoDetailView::test_detail_lancamento PASSED [ 72%]
caixa_nfse/contabil/tests/test_views.py::TestExportarLancamentosView::test_export_csv PASSED [ 73%]
caixa_nfse/core/tests/test_forms.py::TestFormaPagamentoForm::test_valid_form PASSED [ 73%]
caixa_nfse/core/tests/test_forms.py::TestFormaPagamentoForm::test_default_ativo PASSED [ 74%]
caixa_nfse/core/tests/test_forms.py::TestFormaPagamentoForm::test_invalid_taxa PASSED [ 74%]
caixa_nfse/core/tests/test_forms.py::TestFormaPagamentoForm::test_init_with_instance PASSED [ 75%]
caixa_nfse/core/tests/test_models.py::TestTenantModel::test_create_tenant PASSED [ 75%]
caixa_nfse/core/tests/test_models.py::TestTenantModel::test_endereco_completo PASSED [ 76%]
caixa_nfse/core/tests/test_models.py::TestTenantModel::test_endereco_completo_with_complemento PASSED [ 76%]
caixa_nfse/core/tests/test_models.py::TestTenantModel::test_certificado_validity PASSED [ 77%]
caixa_nfse/core/tests/test_models.py::TestTenantModel::test_proximo_numero_rps PASSED [ 77%]
caixa_nfse/core/tests/test_models.py::TestUserModel::test_create_user PASSED [ 78%]
caixa_nfse/core/tests/test_models.py::TestUserModel::test_create_user_no_email PASSED [ 79%]
caixa_nfse/core/tests/test_models.py::TestUserModel::test_create_superuser PASSED [ 79%]
caixa_nfse/core/tests/test_models.py::TestUserModel::test_create_superuser_validation PASSED [ 80%]
caixa_nfse/core/tests/test_models.py::TestFormaPagamentoModel::test_create_forma_pagamento PASSED [ 80%]
caixa_nfse/core/tests/test_models.py::TestFormaPagamentoModel::test_str_representation PASSED [ 81%]
caixa_nfse/core/tests/test_models.py::TestFormaPagamentoModel::test_unique_name_per_tenant PASSED [ 81%]
caixa_nfse/core/tests/test_models.py::TestCoreUtils::test_generate_hash PASSED [ 82%]
caixa_nfse/core/tests/test_models.py::TestCoreUtils::test_tenant_manager_all_with_inactive PASSED [ 82%]
caixa_nfse/core/tests/test_models.py::TestCoreUtils::test_generate_hash_chain PASSED [ 83%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_redirect_superuser PASSED [ 83%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_admin_template PASSED [ 84%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_operador_template PASSED [ 84%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_admin_context_data PASSED [ 85%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_alerts_and_totals FAILED [ 86%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_operador_context_full FAILED [ 86%]
caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_superuser_global_view PASSED [ 87%]
caixa_nfse/core/tests/test_views.py::TestHealthCheckView::test_health_check PASSED [ 87%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoSettings::test_list_formas_pagamento PASSED [ 88%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoSettings::test_create_forma_pagamento PASSED [ 88%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoSettings::test_update_forma_pagamento PASSED [ 89%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoSettings::test_delete_forma_pagamento PASSED [ 89%]
caixa_nfse/core/tests/test_views.py::TestMovimentosListView::test_list_movimentos_gerente PASSED [ 90%]
caixa_nfse/core/tests/test_views.py::TestMovimentosListView::test_list_movimentos_operador PASSED [ 90%]
caixa_nfse/core/tests/test_views.py::TestMovimentosListView::test_list_movimentos_filters PASSED [ 91%]
caixa_nfse/core/tests/test_views.py::TestSettingsView::test_settings_context PASSED [ 91%]
caixa_nfse/core/tests/test_views.py::TestTenantUserSettings::test_list_users PASSED [ 92%]
caixa_nfse/core/tests/test_views.py::TestTenantUserSettings::test_create_user PASSED [ 93%]
caixa_nfse/core/tests/test_views.py::TestTenantUserSettings::test_update_user PASSED [ 93%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoContexts::test_create_forma_pagamento_context PASSED [ 94%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoContexts::test_update_forma_pagamento_context PASSED [ 94%]
caixa_nfse/core/tests/test_views.py::TestFormaPagamentoContexts::test_delete_forma_pagamento_not_found PASSED [ 95%]
caixa_nfse/nfse/tests/test_models.py::TestServicoMunicipalModel::test_create_servico PASSED [ 95%]
caixa_nfse/nfse/tests/test_models.py::TestServicoMunicipalModel::test_unique_codigo_lc116_municipio PASSED [ 96%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_calculation_on_save PASSED [ 96%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_calculation_with_retention PASSED [ 97%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_calculation_with_other_taxes PASSED [ 97%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_pode_cancelar PASSED [ 98%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_str_representation PASSED [ 98%]
caixa_nfse/nfse/tests/test_models.py::TestNotaFiscalServicoModel::test_unique_rps_per_tenant PASSED [ 99%]
caixa_nfse/nfse/tests/test_models.py::TestEventoFiscalModel::test_create_evento PASSED [100%]

=================================== ERRORS ====================================
_ ERROR at setup of TestCoverageGapView.test_rejeitar_fechamento_sem_justificativa _
file C:\Users\Rodrigo\Projetos\wCaixaDigital\caixa_nfse\caixa\tests\test_views_extra.py, line 411
      def test_rejeitar_fechamento_sem_justificativa(self, client_logged, user, fechamento):
E       fixture 'fechamento' not found
>       available fixtures: _dj_autoclear_mailbox, _django_clear_site_cache, _django_db_helper, _django_db_marker, _django_set_urlconf, _django_setup_unittest, _fail_for_invalid_template_variable, _live_server_helper, _session_faker, _template_string_if_invalid_marker, abertura, admin_client, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, async_client, async_rf, cache, caixa, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, client, client_logged, db, django_assert_max_num_queries, django_assert_num_queries, django_capture_on_commit_callbacks, django_db_blocker, django_db_createdb, django_db_keepdb, django_db_modify_db_settings, django_db_modify_db_settings_parallel_suffix, django_db_modify_db_settings_tox_suffix, django_db_modify_db_settings_xdist_suffix, django_db_reset_sequences, django_db_serialized_rollback, django_db_setup, django_db_use_migrations, django_mail_dnsname, django_mail_patch_dns, django_test_environment, django_user_model, django_username_field, doctest_namespace, faker, forma_pagamento, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, live_server, mailoutbox, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, rf, settings, subtests, tenant, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transactional_db, user
>       use 'pytest --fixtures [testpath]' for help on them.

C:\Users\Rodrigo\Projetos\wCaixaDigital\caixa_nfse\caixa\tests\test_views_extra.py:411
================================== FAILURES ===================================
_____________ TestCaixaViewSet.test_list_caixas_tenant_isolation ______________
caixa_nfse\api\tests\test_views.py:28: in test_list_caixas_tenant_isolation
    response = self.client.get(self.url)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:237: in generic
    return super().generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:198: in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\views\decorators\csrf.py:65: in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\viewsets.py:125: in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:515: in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:475: in handle_exception
    self.raise_uncaught_exception(exc)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:486: in raise_uncaught_exception
    raise exc
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:512: in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\mixins.py:40: in list
    page = self.paginate_queryset(queryset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\generics.py:175: in paginate_queryset
    return self.paginator.paginate_queryset(queryset, self.request, view=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\pagination.py:630: in paginate_queryset
    queryset = queryset.order_by(*self.ordering)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1772: in order_by
    obj.query.add_ordering(*field_names)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:2333: in add_ordering
    self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:1832: in names_to_path
    raise FieldError(
E   django.core.exceptions.FieldError: Cannot resolve keyword 'created' into field. Choices are: aberturas, ativo, created_at, created_by, created_by_id, id, identificador, operador_atual, operador_atual_id, saldo_atual, status, tenant, tenant_id, tipo, updated_at, updated_by, updated_by_id
__________________ TestCaixaViewSet.test_list_no_tenant_user __________________
caixa_nfse\api\tests\test_views.py:42: in test_list_no_tenant_user
    response = client.get(self.url)
               ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:237: in generic
    return super().generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:198: in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\views\decorators\csrf.py:65: in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\viewsets.py:125: in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:515: in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:475: in handle_exception
    self.raise_uncaught_exception(exc)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:486: in raise_uncaught_exception
    raise exc
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:512: in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\mixins.py:40: in list
    page = self.paginate_queryset(queryset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\generics.py:175: in paginate_queryset
    return self.paginator.paginate_queryset(queryset, self.request, view=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\pagination.py:630: in paginate_queryset
    queryset = queryset.order_by(*self.ordering)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1772: in order_by
    obj.query.add_ordering(*field_names)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:2333: in add_ordering
    self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:1832: in names_to_path
    raise FieldError(
E   django.core.exceptions.FieldError: Cannot resolve keyword 'created' into field. Choices are: aberturas, ativo, created_at, created_by, created_by_id, id, identificador, operador_atual, operador_atual_id, saldo_atual, status, tenant, tenant_id, tipo, updated_at, updated_by, updated_by_id
____________________ TestClienteViewSet.test_list_clientes ____________________
caixa_nfse\api\tests\test_views.py:72: in test_list_clientes
    response = self.client.get(self.url)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:237: in generic
    return super().generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:198: in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\views\decorators\csrf.py:65: in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\viewsets.py:125: in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:515: in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:475: in handle_exception
    self.raise_uncaught_exception(exc)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:486: in raise_uncaught_exception
    raise exc
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:512: in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\mixins.py:40: in list
    page = self.paginate_queryset(queryset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\generics.py:175: in paginate_queryset
    return self.paginator.paginate_queryset(queryset, self.request, view=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\pagination.py:630: in paginate_queryset
    queryset = queryset.order_by(*self.ordering)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1772: in order_by
    obj.query.add_ordering(*field_names)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:2333: in add_ordering
    self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:1832: in names_to_path
    raise FieldError(
E   django.core.exceptions.FieldError: Cannot resolve keyword 'created' into field. Choices are: ativo, bairro, cep, cidade, codigo_ibge, complemento, consentimento_lgpd, cpf_cnpj, cpf_cnpj_hash, created_at, created_by, created_by_id, data_consentimento, email, id, inscricao_estadual, inscricao_municipal, logradouro, movimentos_caixa, nome_fantasia, notas_fiscais, numero, razao_social, telefone, tenant, tenant_id, tipo_pessoa, uf, updated_at, updated_by, updated_by_id
____________________ TestNotaFiscalViewSet.test_list_notas ____________________
caixa_nfse\api\tests\test_views.py:105: in test_list_notas
    response = self.client.get(self.url)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:237: in generic
    return super().generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:198: in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\views\decorators\csrf.py:65: in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\viewsets.py:125: in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:515: in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:475: in handle_exception
    self.raise_uncaught_exception(exc)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:486: in raise_uncaught_exception
    raise exc
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:512: in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\mixins.py:40: in list
    page = self.paginate_queryset(queryset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\generics.py:175: in paginate_queryset
    return self.paginator.paginate_queryset(queryset, self.request, view=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\pagination.py:630: in paginate_queryset
    queryset = queryset.order_by(*self.ordering)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1772: in order_by
    obj.query.add_ordering(*field_names)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:2333: in add_ordering
    self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\query.py:1832: in names_to_path
    raise FieldError(
E   django.core.exceptions.FieldError: Cannot resolve keyword 'created' into field. Choices are: aliquota_iss, base_calculo, cliente, cliente_id, codigo_verificacao, competencia, created_at, created_by, created_by_id, data_cancelamento, data_emissao, discriminacao, eventos, id, iss_retido, local_prestacao_ibge, motivo_cancelamento, movimentos_caixa, nota_substituida, nota_substituida_id, nota_substituta, numero_nfse, numero_rps, pdf_url, protocolo, serie_rps, servico, servico_id, status, tenant, tenant_id, updated_at, updated_by, updated_by_id, valor_cofins, valor_csll, valor_deducoes, valor_inss, valor_ir, valor_iss, valor_liquido, valor_pis, valor_servicos, xml_nfse, xml_rps
________________ TestNotaFiscalViewSet.test_create_nota_simple ________________
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\serializers.py:991: in create
    instance = ModelClass._default_manager.create(**validated_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:669: in create
    obj.save(force_insert=True, using=self.db)
caixa_nfse\nfse\models.py:288: in save
    self.valor_iss = self.base_calculo * self.aliquota_iss
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'NoneType'

During handling of the above exception, another exception occurred:
caixa_nfse\api\tests\test_views.py:127: in test_create_nota_simple
    response = self.client.post(self.url, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:299: in post
    response = super().post(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:213: in post
    return self.generic('POST', path, data, content_type, **extra)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:237: in generic
    return super().generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:198: in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\views\decorators\csrf.py:65: in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\viewsets.py:125: in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:515: in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:475: in handle_exception
    self.raise_uncaught_exception(exc)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:486: in raise_uncaught_exception
    raise exc
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\views.py:512: in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\mixins.py:19: in create
    self.perform_create(serializer)
caixa_nfse\api\views.py:61: in perform_create
    serializer.save(tenant=self.request.user.tenant)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\serializers.py:210: in save
    self.instance = self.create(validated_data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\serializers.py:1010: in create
    raise TypeError(msg)
E   TypeError: Got a `TypeError` when calling `NotaFiscalServico.objects.create()`. This may be because you have a writable field on the serializer class that is not a valid argument to `NotaFiscalServico.objects.create()`. You may need to make the field read-only, or override the NotaFiscalSerializer.create() method to handle this correctly.
E   Original exception was:
E    Traceback (most recent call last):
E     File "C:\Users\Rodrigo\AppData\Local\Programs\Python\Python314\Lib\site-packages\rest_framework\serializers.py", line 991, in create
E       instance = ModelClass._default_manager.create(**validated_data)
E     File "C:\Users\Rodrigo\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
E       return getattr(self.get_queryset(), name)(*args, **kwargs)
E              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
E     File "C:\Users\Rodrigo\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py", line 669, in create
E       obj.save(force_insert=True, using=self.db)
E       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E     File "C:\Users\Rodrigo\Projetos\wCaixaDigital\caixa_nfse\nfse\models.py", line 288, in save
E       self.valor_iss = self.base_calculo * self.aliquota_iss
E                        ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
E   TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'NoneType'
__________________ TestRegistroAuditoriaModel.test_chaining ___________________
caixa_nfse\auditoria\tests\test_models.py:23: in test_chaining
    assert r2.hash_anterior == r1.hash_registro
E   AssertionError: assert '1774b13ccae2...eb4352cdee6b4' == 'a2d3a75b682e...a13b581e8129a'
E     
E     - a2d3a75b682ee6ec4cab5992a381a0aa71a391d6aabefe44249a13b581e8129a
E     + 1774b13ccae2f8ecc9b28a36e329d66a366c4e3743b4d686276eb4352cdee6b4
___________ TestRegistroAuditoriaModel.test_registrar_with_request ____________
caixa_nfse\auditoria\tests\test_models.py:57: in test_registrar_with_request
    record = RegistroAuditoria.registrar(
caixa_nfse\auditoria\models.py:216: in registrar
    session_id = request.session.session_key or ""
                 ^^^^^^^^^^^^^^^
E   AttributeError: 'WSGIRequest' object has no attribute 'session'
__________ TestRegistroAuditoriaModel.test_integridade_tenant_filter __________
caixa_nfse\auditoria\tests\test_models.py:73: in test_integridade_tenant_filter
    assert valid is True
E   assert False is True
_____________ TestRegistroAuditoriaModel.test_integridade_broken ______________
caixa_nfse\auditoria\tests\test_models.py:89: in test_integridade_broken
    assert r2.hash_anterior == r1.hash_registro
E   AssertionError: assert '6b489edb7583...f4c89853057e3' == '76f3bf996d4f...1760cc8bb63b7'
E     
E     - 76f3bf996d4feac96185b0426754c5d7e00583693578013268d1760cc8bb63b7
E     + 6b489edb7583286492b2ba1c5646d2f99987af69c49872f4eabf4c89853057e3
___________________ TestTenantCRUD.test_create_tenant_flow ____________________
caixa_nfse\backoffice\tests\test_views.py:80: in test_create_tenant_flow
    assert response.status_code == 302  # Redirects to dashboard
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 200 == 302
E    +  where 200 = <TemplateResponse status_code=200, "text/html; charset=utf-8">.status_code
______________________ TestTenantCRUD.test_delete_tenant ______________________
caixa_nfse\backoffice\tests\test_views.py:87: in test_delete_tenant
    assert not tenant.pk  # Basic delete check, or refresh from db
    ^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert not UUID('5f6892d6-86bd-46f0-9dee-384d17594821')
E    +  where UUID('5f6892d6-86bd-46f0-9dee-384d17594821') = <Tenant: Empresa 49 Ltda (00000000000049)>.pk
_______________ TestAberturaCaixaModel.test_is_operacional_hoje _______________
caixa_nfse\caixa\tests\test_models.py:136: in test_is_operacional_hoje
    assert abertura.is_operacional_hoje is True
E   assert False is True
E    +  where False = <AberturaCaixa: Abertura CAIXA-01 - 06/02/2026 01:40>.is_operacional_hoje
________________ TestNovoMovimentoView.test_movimento_success _________________
caixa_nfse\caixa\tests\test_views.py:132: in test_movimento_success
    assert abertura.movimentos.count() == 1
E   assert 0 == 1
E    +  where 0 = count()
E    +    where count = <django.db.models.fields.related_descriptors.create_reverse_many_to_one_manager.<locals>.RelatedManager object at 0x000002D2A38D2D50>.count
E    +      where <django.db.models.fields.related_descriptors.create_reverse_many_to_one_manager.<locals>.RelatedManager object at 0x000002D2A38D2D50> = <AberturaCaixa: Abertura CAIXA-01 - 06/02/2026 01:40>.movimentos
______________ TestNovoMovimentoView.test_movimento_invalid_form ______________
caixa_nfse\caixa\tests\test_views.py:149: in test_movimento_invalid_form
    assert response.status_code == 200
E   assert 302 == 200
E    +  where 302 = <HttpResponseRedirect status_code=302, "text/html; charset=utf-8", url="/caixa/abertura/b354c18e-5229-4c06-847e-51f64db2f5be/movimentos/">.status_code
________ TestNovoMovimentoExtra.test_movimento_saida_decreases_balance ________
caixa_nfse\caixa\tests\test_views_extra.py:197: in test_movimento_saida_decreases_balance
    assert caixa.saldo_atual == Decimal("70.00")
E   AssertionError: assert Decimal('100.00') == Decimal('70.00')
E    +  where Decimal('100.00') = <Caixa: CAIXA-01 (Aberto)>.saldo_atual
E    +  and   Decimal('70.00') = Decimal('70.00')
___________ TestNovoMovimentoExtra.test_block_retroactive_movement ____________
caixa_nfse\caixa\tests\test_views_extra.py:209: in test_block_retroactive_movement
    assert response.status_code == 302
E   assert 200 == 302
E    +  where 200 = <TemplateResponse status_code=200, "text/html; charset=utf-8">.status_code
__________ TestNovoMovimentoExtra.test_htmx_request_returns_partial ___________
caixa_nfse\caixa\tests\test_views_extra.py:216: in test_htmx_request_returns_partial
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <HttpResponseForbidden status_code=403, "text/html; charset=utf-8">.status_code
___________ TestNovoMovimentoHTMX.test_movimento_htmx_post_success ____________
caixa_nfse\caixa\tests\test_views_extra.py:346: in test_movimento_htmx_post_success
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <HttpResponseForbidden status_code=403, "text/html; charset=utf-8">.status_code
___________ TestCoverageGapView.test_fechar_caixa_post_no_abertura ____________
caixa_nfse\caixa\tests\test_views_extra.py:408: in test_fechar_caixa_post_no_abertura
    assert response.status_code == 302
E   assert 403 == 302
E    +  where 403 = <HttpResponseForbidden status_code=403, "text/html; charset=utf-8">.status_code
__________ TestCoverageGapView.test_novo_movimento_retroactive_htmx ___________
caixa_nfse\caixa\tests\test_views_extra.py:440: in test_novo_movimento_retroactive_htmx
    assert response.status_code == 403
E   assert 200 == 403
E    +  where 200 = <TemplateResponse status_code=200, "text/html; charset=utf-8">.status_code
___________ TestCoverageFinal.test_fechar_caixa_post_race_condition ___________
caixa_nfse\caixa\tests\test_views_extra.py:519: in test_fechar_caixa_post_race_condition
    assert response.status_code == 302
E   assert 403 == 302
E    +  where 403 = <HttpResponseForbidden status_code=403, "text/html; charset=utf-8">.status_code
____________________ TestClienteModel.test_valid_documents ____________________
caixa_nfse\clientes\tests\test_models.py:25: in test_valid_documents
    c_pf.full_clean()  # Should result in validation success (return True)
    ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:1710: in full_clean
    raise ValidationError(errors)
E   django.core.exceptions.ValidationError: {'tenant': ["A instncia de empresa com id UUID('d8a48a66-ac0f-4935-b452-94e849472c7a') no  uma escolha vlida."]}
_______________ TestPlanoContasListView.test_list_plano_contas ________________
caixa_nfse\contabil\tests\test_views.py:32: in test_list_plano_contas
    response = client_logged.get(url)
               ^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1124: in get
    response = super().get(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:475: in get
    return self.generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:221: in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:114: in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:92: in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\backends\django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:174: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:160: in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:66: in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\defaulttags.py:511: in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\base.py:98: in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\resolvers.py:842: in _reverse_with_prefix
    raise NoReverseMatch(msg)
E   django.urls.exceptions.NoReverseMatch: Reverse for 'contas' not found. 'contas' is not a valid view function or pattern name.
_________________ TestPlanoContasListView.test_filter_tenant __________________
caixa_nfse\contabil\tests\test_views.py:42: in test_filter_tenant
    response = client_logged.get(url)
               ^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1124: in get
    response = super().get(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:475: in get
    return self.generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:221: in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:114: in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:92: in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\backends\django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:174: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:160: in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:66: in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\defaulttags.py:511: in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\base.py:98: in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\resolvers.py:842: in _reverse_with_prefix
    raise NoReverseMatch(msg)
E   django.urls.exceptions.NoReverseMatch: Reverse for 'contas' not found. 'contas' is not a valid view function or pattern name.
_____________ TestPlanoContasListView.test_access_without_tenant ______________
caixa_nfse\contabil\tests\test_views.py:54: in test_access_without_tenant
    response = client.get(url)
               ^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1124: in get
    response = super().get(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:475: in get
    return self.generic(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\core\handlers\base.py:221: in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:114: in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\response.py:92: in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\backends\django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:174: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:160: in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\loader_tags.py:66: in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\template\defaulttags.py:511: in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\base.py:98: in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\resolvers.py:842: in _reverse_with_prefix
    raise NoReverseMatch(msg)
E   django.urls.exceptions.NoReverseMatch: Reverse for 'contas' not found. 'contas' is not a valid view function or pattern name.
________________ TestLancamentoListView.test_list_lancamentos _________________
caixa_nfse\contabil\tests\test_views.py:66: in test_list_lancamentos
    url = reverse("contabil:lancamento_list")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\base.py:98: in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\urls\resolvers.py:842: in _reverse_with_prefix
    raise NoReverseMatch(msg)
E   django.urls.exceptions.NoReverseMatch: Reverse for 'lancamento_list' not found. 'lancamento_list' is not a valid view function or pattern name.
_____________ TestDashboardView.test_dashboard_alerts_and_totals ______________
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\sqlite3\base.py:359: in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   sqlite3.IntegrityError: NOT NULL constraint failed: caixa_aberturacaixa.saldo_abertura

The above exception was the direct cause of the following exception:
caixa_nfse\core\tests\test_views.py:76: in test_dashboard_alerts_and_totals
    abertura = AberturaCaixa.objects.create(caixa=caixa, operador=operador, tenant=tenant)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:669: in create
    obj.save(force_insert=True, using=self.db)
caixa_nfse\caixa\models.py:190: in save
    super().save(*args, **kwargs)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:874: in save
    self.save_base(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:966: in save_base
    updated = self._save_table(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:1167: in _save_table
    results = self._do_insert(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:1218: in _do_insert
    return manager._insert(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1918: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\compiler.py:1925: in execute_sql
    cursor.execute(sql, params)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:79: in execute
    return self._execute_with_wrappers(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:100: in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\utils.py:94: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\sqlite3\base.py:359: in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   django.db.utils.IntegrityError: NOT NULL constraint failed: caixa_aberturacaixa.saldo_abertura
___________ TestDashboardView.test_dashboard_operador_context_full ____________
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\sqlite3\base.py:359: in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   sqlite3.IntegrityError: NOT NULL constraint failed: caixa_aberturacaixa.saldo_abertura

The above exception was the direct cause of the following exception:
caixa_nfse\core\tests\test_views.py:130: in test_dashboard_operador_context_full
    abertura = AberturaCaixa.objects.create(caixa=caixa, operador=user, tenant=tenant)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:669: in create
    obj.save(force_insert=True, using=self.db)
caixa_nfse\caixa\models.py:190: in save
    super().save(*args, **kwargs)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:874: in save
    self.save_base(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:966: in save_base
    updated = self._save_table(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:1167: in _save_table
    results = self._do_insert(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\base.py:1218: in _do_insert
    return manager._insert(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\query.py:1918: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\models\sql\compiler.py:1925: in execute_sql
    cursor.execute(sql, params)
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:79: in execute
    return self._execute_with_wrappers(
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:100: in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\utils.py:94: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\AppData\Local\Programs\Python\Python314\Lib\site-packages\django\db\backends\sqlite3\base.py:359: in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   django.db.utils.IntegrityError: NOT NULL constraint failed: caixa_aberturacaixa.saldo_abertura
============================== warnings summary ===============================
caixa_nfse/api/tests/test_views.py: 8 warnings
caixa_nfse/auditoria/tests/test_models.py: 13 warnings
caixa_nfse/backoffice/tests/test_forms.py: 1 warning
caixa_nfse/backoffice/tests/test_views.py: 9 warnings
caixa_nfse/contabil/tests/test_views.py: 1 warning
caixa_nfse/core/tests/test_models.py: 1 warning
caixa_nfse/core/tests/test_views.py: 25 warnings
  C:\Users\Rodrigo\AppData\Local\Programs\Python\Python314\Lib\site-packages\factory\django.py:182: DeprecationWarning: UserFactory._after_postgeneration will stop saving the instance after postgeneration hooks in the next major release.
  If the save call is extraneous, set skip_postgeneration_save=True in the UserFactory.Meta.
  To keep saving the instance, move the save call to your postgeneration hooks or override _after_postgeneration.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED caixa_nfse/api/tests/test_views.py::TestCaixaViewSet::test_list_caixas_tenant_isolation
FAILED caixa_nfse/api/tests/test_views.py::TestCaixaViewSet::test_list_no_tenant_user
FAILED caixa_nfse/api/tests/test_views.py::TestClienteViewSet::test_list_clientes
FAILED caixa_nfse/api/tests/test_views.py::TestNotaFiscalViewSet::test_list_notas
FAILED caixa_nfse/api/tests/test_views.py::TestNotaFiscalViewSet::test_create_nota_simple
FAILED caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_chaining
FAILED caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_registrar_with_request
FAILED caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_integridade_tenant_filter
FAILED caixa_nfse/auditoria/tests/test_models.py::TestRegistroAuditoriaModel::test_integridade_broken
FAILED caixa_nfse/backoffice/tests/test_views.py::TestTenantCRUD::test_create_tenant_flow
FAILED caixa_nfse/backoffice/tests/test_views.py::TestTenantCRUD::test_delete_tenant
FAILED caixa_nfse/caixa/tests/test_models.py::TestAberturaCaixaModel::test_is_operacional_hoje
FAILED caixa_nfse/caixa/tests/test_views.py::TestNovoMovimentoView::test_movimento_success
FAILED caixa_nfse/caixa/tests/test_views.py::TestNovoMovimentoView::test_movimento_invalid_form
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_movimento_saida_decreases_balance
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_block_retroactive_movement
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoExtra::test_htmx_request_returns_partial
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestNovoMovimentoHTMX::test_movimento_htmx_post_success
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_fechar_caixa_post_no_abertura
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_novo_movimento_retroactive_htmx
FAILED caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageFinal::test_fechar_caixa_post_race_condition
FAILED caixa_nfse/clientes/tests/test_models.py::TestClienteModel::test_valid_documents
FAILED caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_list_plano_contas
FAILED caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_filter_tenant
FAILED caixa_nfse/contabil/tests/test_views.py::TestPlanoContasListView::test_access_without_tenant
FAILED caixa_nfse/contabil/tests/test_views.py::TestLancamentoListView::test_list_lancamentos
FAILED caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_alerts_and_totals
FAILED caixa_nfse/core/tests/test_views.py::TestDashboardView::test_dashboard_operador_context_full
ERROR caixa_nfse/caixa/tests/test_views_extra.py::TestCoverageGapView::test_rejeitar_fechamento_sem_justificativa
============ 28 failed, 157 passed, 58 warnings, 1 error in 4.28s =============
