<div class="fixed inset-0 z-[60] flex items-center justify-center p-4 sm:p-6" 
     role="dialog" 
     aria-modal="true"
     x-data="{ show: true }"
     x-show="show"
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
     x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
     x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95">

    <!-- Backdrop -->
    <div class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm transition-opacity" 
         @click="show = false; setTimeout(() => $el.closest('#modal-container').innerHTML = '', 300);"></div>

    <!-- Modal Panel -->
    <div class="relative transform overflow-hidden rounded-xl bg-white dark:bg-surface-dark text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md border border-slate-200 dark:border-border-dark">
        <div class="px-4 pb-4 pt-5 sm:p-6 sm:pb-4 border-b border-slate-100 dark:border-border-dark">
            <div class="sm:flex sm:items-start">
                <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30 sm:mx-0 sm:h-10 sm:w-10">
                    <span class="material-symbols-outlined text-blue-600 dark:text-blue-400">lock_reset</span>
                </div>
                <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                    <h3 class="text-lg font-semibold leading-6 text-slate-900 dark:text-white" id="modal-title">Redefinir Senha</h3>
                    <div class="mt-2">
                        <p class="text-sm text-slate-500 dark:text-slate-400">
                            Defina uma nova senha para <strong>{{ object.get_full_name }}</strong>.
                        </p>
                    </div>
                </div>
                <button type="button" 
                        class="absolute right-4 top-4 text-slate-400 hover:text-slate-500"
                        @click="show = false; setTimeout(() => $el.closest('#modal-container').innerHTML = '', 300);">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
        </div>
        
        <form hx-post="{% url 'core:settings_user_reset_password' object.pk %}" hx-target="#modal-container" class="px-4 py-4 sm:p-6">
            {% csrf_token %}
            
            <div class="space-y-4">
                {% for field in form %}
                <div class="space-y-1">
                    <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-slate-700 dark:text-slate-300">
                        {{ field.label }}
                    </label>
                    <input type="{{ field.field.widget.input_type }}" 
                           name="{{ field.name }}" 
                           id="{{ field.id_for_label }}"
                           class="block w-full rounded-lg border-slate-200 dark:border-border-dark bg-slate-50 dark:bg-background-dark text-slate-900 dark:text-white focus:border-primary focus:ring-primary sm:text-sm"
                           {% if field.field.required %}required{% endif %}>
                    {% if field.help_text %}
                    <p class="text-xs text-slate-400">{{ field.help_text|safe }}</p>
                    {% endif %}
                    {% if field.errors %}
                    <p class="text-xs text-danger">{{ field.errors.0 }}</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <div class="mt-6 flex items-center justify-end gap-3 border-t border-slate-100 dark:border-border-dark pt-4">
                <button type="button" 
                        class="rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-surface-dark px-4 py-2 text-sm font-semibold text-slate-700 dark:text-slate-200 shadow-sm hover:bg-slate-50 dark:hover:bg-background-dark"
                        @click="show = false; setTimeout(() => $el.closest('#modal-container').innerHTML = '', 300);">
                    Cancelar
                </button>
                
                <button type="submit" 
                        class="flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600">
                    <span class="material-symbols-outlined text-sm">save</span>
                    Salvar Nova Senha
                </button>
            </div>
        </form>
    </div>
</div>
